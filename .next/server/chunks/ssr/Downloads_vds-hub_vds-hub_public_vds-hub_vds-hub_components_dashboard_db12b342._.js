module.exports=[81329,a=>{"use strict";var b=a.i(28308),c=a.i(7594),d=a.i(58724),e=a.i(63834);let f=(0,e.default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),g=(0,e.default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);var h=a.i(25417);let i=(0,e.default)("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),j=(0,e.default)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var k=a.i(10552),l=a.i(16474),m=a.i(1876),n=a.i(13655),o=a.i(40565),p=a.i(33024),q=a.i(25491);async function r(){return{totalTopups:250,activeServers:3,referralIncome:12.5,telegram:"@johndoe",createdAt:"2025-01-15T10:30:00Z",email:"new_email@example.com"}}async function s(a,b){let c=new FormData;c.append("file",a),c.append("userId",b);let d=await fetch("/api/profile/avatar",{method:"POST",body:c});return await d.json()}async function t(a){return a&&/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(a)?{success:!0,email:a}:{success:!1}}function u(){let{user:a,refresh:e}=(0,m.useAuth)(),u=a?.profile,{toast:v}=(0,o.useToast)(),w=(0,n.useRef)(null),[x,y]=(0,n.useState)({totalTopups:0,activeServers:0,referralIncome:0,telegram:"",createdAt:"",email:""}),[z,A]=(0,n.useState)(u?.avatarUrl??null),[B,C]=(0,n.useState)(!1),[D,E]=(0,n.useState)(!1),[F,G]=(0,n.useState)(""),[H,I]=(0,n.useState)(!1);if((0,n.useEffect)(()=>{r().then(y).catch(()=>{})},[]),(0,n.useEffect)(()=>{G(x.email&&x.email!==a?.email?x.email:a?.email||"")},[x,a]),(0,n.useEffect)(()=>{u?.avatarUrl&&A(u.avatarUrl)},[u?.avatarUrl]),!a)return null;let J=x.email&&x.email!==a.email?x.email:a.email,K=x.email&&x.email!==a.email?a.email:null,L=u?.fullName||a.name||J,M=L?L.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2):"U",N=x.createdAt?new Date(x.createdAt).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"}):"—",O=a.id?a.id.slice(0,8):"",P=x.telegram||"",Q=async b=>{let c=b.target.files?.[0];if(c){if(!c.type.startsWith("image/"))return void v({title:"Ошибка",description:"Можно загрузить только изображение.",variant:"destructive"});if(c.size>3145728)return void v({title:"Ошибка",description:"Максимальный размер файла — 3МБ.",variant:"destructive"});C(!0);try{let b=await s(c,a.id);if(!b.success||!b.url)throw Error("Fail");A(b.url),v({title:"Успешно",description:"Аватар обновлён"}),e&&await e()}catch{v({title:"Ошибка",description:"Не удалось загрузить аватар",variant:"destructive"})}finally{C(!1),w.current&&(w.current.value="")}}},R=async()=>{if(!F||F===J)return void E(!1);I(!0);try{if(!(await t(F)).success)throw Error("Failed");y(a=>({...a,email:F})),v({title:"Успешно",description:"Почта обновлена. Проверьте почту для подтверждения."}),E(!1),e&&await e()}catch{v({title:"Ошибка",description:"Не удалось изменить email.",variant:"destructive"})}finally{I(!1)}};return(0,b.jsx)("div",{className:"card-gradient rounded-xl p-6 lg:p-8 border border-border/50",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center md:items-start gap-4",children:[(0,b.jsxs)("div",{className:"relative group cursor-pointer w-36 h-36 transition-transform duration-300 hover:scale-[1.03]",onClick:()=>!B&&w.current?.click(),children:[(0,b.jsx)(c.Avatar,{className:"w-36 h-36 border-2 border-primary/40 shadow-lg",children:(0,b.jsx)(q.AnimatePresence,{mode:"wait",children:z?(0,b.jsx)(p.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"w-full h-full",children:(0,b.jsx)(c.AvatarImage,{src:z,alt:"avatar",className:"object-cover w-full h-full"})},z):(0,b.jsx)(c.AvatarFallback,{className:"text-3xl bg-primary text-primary-foreground",children:M})})}),(0,b.jsxs)("div",{className:"absolute inset-0 flex items-end justify-end opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/40 rounded-full"}),(0,b.jsx)("div",{className:"relative m-2 rounded-full bg-white/75 p-2 shadow-md z-10",children:(0,b.jsx)(j,{className:"w-6 h-6 text-primary"})})]}),B&&(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/40 rounded-full",children:(0,b.jsxs)("svg",{className:"animate-spin h-7 w-7 text-primary",viewBox:"0 0 24 24",children:[(0,b.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,b.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]})}),(0,b.jsx)("input",{ref:w,type:"file",accept:"image/*",className:"hidden",onChange:Q})]}),(0,b.jsx)(d.Badge,{variant:"secondary",className:"text-sm",children:"admin"===a.role?"Admin":"User"})]}),(0,b.jsxs)("div",{className:"flex-1 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-foreground mb-1",children:L}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"—"!==N?`Участник с ${N}`:"—"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center",children:(0,b.jsx)(g,{className:"w-5 h-5 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:K?"Новая почта":"Email"}),D?(0,b.jsxs)("div",{className:"flex gap-2 items-center mt-1",children:[(0,b.jsx)(k.Input,{value:F,onChange:a=>G(a.target.value),placeholder:"Новый email",className:"max-w-xs h-8 px-2 py-1 text-sm",disabled:H,autoFocus:!0,type:"email"}),(0,b.jsx)(l.Button,{size:"sm",variant:"outline",onClick:R,disabled:H||!F||!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(F),className:"px-2",children:H?"...":"Сохранить"}),(0,b.jsx)(l.Button,{size:"icon",variant:"ghost",onClick:()=>E(!1),className:"w-7 h-7",type:"button",children:"✕"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-foreground inline-block",children:J}),(0,b.jsx)(l.Button,{size:"sm",variant:"link",className:"px-1 text-xs ml-2",onClick:()=>E(!0),type:"button",children:"Изменить"})]}),K&&!D&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:(0,b.jsxs)("span",{className:"opacity-70",children:["Старая: ",K]})})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center",children:(0,b.jsx)(h.Send,{className:"w-5 h-5 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Telegram"}),(0,b.jsx)("p",{className:"text-sm font-medium text-foreground",children:P||"—"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center",children:(0,b.jsx)(f,{className:"w-5 h-5 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Дата регистрации"}),(0,b.jsx)("p",{className:"text-sm font-medium text-foreground",children:N})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center",children:(0,b.jsx)(i,{className:"w-5 h-5 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"ID пользователя"}),(0,b.jsxs)("p",{className:"text-sm font-medium text-foreground",children:["#",O]})]})]})]}),(0,b.jsx)("div",{className:"pt-4 border-t border-border/50",children:(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Всего пополнений"}),(0,b.jsxs)("p",{className:"text-xl font-bold text-foreground",children:["$",x.totalTopups.toFixed(2)]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Активных серверов"}),(0,b.jsx)("p",{className:"text-xl font-bold text-foreground",children:x.activeServers})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Реферальный доход"}),(0,b.jsxs)("p",{className:"text-xl font-bold text-foreground",children:["$",x.referralIncome.toFixed(2)]})]})]})})]})]})})}a.s(["ProfileInfo",()=>u],81329)},1792,a=>{"use strict";var b=a.i(28308),c=a.i(16474),d=a.i(10552),e=a.i(13712),f=a.i(13655),g=a.i(40565),h=a.i(1876),i=a.i(44808);function j(){let{user:a,refresh:j}=(0,h.useAuth)(),{toast:k}=(0,g.useToast)(),{language:l}=(0,i.useLanguage)(),[m,n]=(0,f.useState)(""),[o,p]=(0,f.useState)(""),[q,r]=(0,f.useState)(""),[s,t]=(0,f.useState)(""),[u,v]=(0,f.useState)(!1),[w,x]=(0,f.useState)(!1);(0,f.useEffect)(()=>{a?.profile?.fullName&&n(a.profile.fullName)},[a]);let y=async()=>{v(!0);try{if(!(await fetch("/api/profile",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullName:m})})).ok)throw Error("Failed to update profile");await j(),k({title:"ru"===l?"Успешно":"Success",description:"ru"===l?"Профиль обновлен":"Profile updated"})}catch(a){k({title:"ru"===l?"Ошибка":"Error",description:"ru"===l?"Не удалось обновить профиль":"Failed to update profile",variant:"destructive"})}finally{v(!1)}},z=async()=>{if(q!==s)return void k({title:"ru"===l?"Ошибка":"Error",description:"ru"===l?"Пароли не совпадают":"Passwords do not match",variant:"destructive"});if(q.length<8)return void k({title:"ru"===l?"Ошибка":"Error",description:"ru"===l?"Пароль должен быть не менее 8 символов":"Password must be at least 8 characters",variant:"destructive"});x(!0);try{let a=await fetch("/api/user/password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:o,newPassword:q})}),b=await a.json();if(!a.ok)throw Error(b.error||"Failed to change password");p(""),r(""),t(""),k({title:"ru"===l?"Успешно":"Success",description:"ru"===l?"Пароль успешно изменен":"Password changed successfully"})}catch(a){k({title:"ru"===l?"Ошибка":"Error",description:a.message||("ru"===l?"Не удалось изменить пароль":"Failed to change password"),variant:"destructive"})}finally{x(!1)}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"card-gradient rounded-xl p-6 lg:p-8 border border-border/50",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-foreground mb-6",children:"ru"===l?"Настройки профиля":"Profile Settings"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(e.Label,{htmlFor:"fullName",className:"text-foreground",children:"ru"===l?"Полное имя":"Full Name"}),(0,b.jsx)(d.Input,{id:"fullName",value:m,onChange:a=>n(a.target.value),className:"bg-background/50 border-border/50 focus:border-primary",placeholder:"ru"===l?"Введите ваше имя":"Enter your name"})]}),(0,b.jsx)(c.Button,{className:"bg-primary hover:bg-primary/90",onClick:y,disabled:u,children:u?"ru"===l?"Сохранение...":"Saving...":"ru"===l?"Сохранить изменения":"Save changes"})]})]}),(0,b.jsxs)("div",{className:"card-gradient rounded-xl p-6 lg:p-8 border border-border/50",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-foreground mb-6",children:"ru"===l?"Изменить пароль":"Change Password"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(e.Label,{htmlFor:"current-password",className:"text-foreground",children:"ru"===l?"Текущий пароль":"Current Password"}),(0,b.jsx)(d.Input,{id:"current-password",type:"password",value:o,onChange:a=>p(a.target.value),className:"bg-background/50 border-border/50 focus:border-primary"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(e.Label,{htmlFor:"new-password",className:"text-foreground",children:"ru"===l?"Новый пароль":"New Password"}),(0,b.jsx)(d.Input,{id:"new-password",type:"password",value:q,onChange:a=>r(a.target.value),className:"bg-background/50 border-border/50 focus:border-primary"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(e.Label,{htmlFor:"confirm-new-password",className:"text-foreground",children:"ru"===l?"Подтвердите новый пароль":"Confirm New Password"}),(0,b.jsx)(d.Input,{id:"confirm-new-password",type:"password",value:s,onChange:a=>t(a.target.value),className:"bg-background/50 border-border/50 focus:border-primary"})]}),(0,b.jsx)(c.Button,{className:"bg-primary hover:bg-primary/90",onClick:z,disabled:w,children:w?"ru"===l?"Изменение...":"Changing...":"ru"===l?"Изменить пароль":"Change Password"})]})]})]})}a.s(["ProfileSettings",()=>j])}];

//# sourceMappingURL=Downloads_vds-hub_vds-hub_public_vds-hub_vds-hub_components_dashboard_db12b342._.js.map