(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,23750,e=>{"use strict";var t=e.i(43476),r=e.i(47163);function s({className:e,type:s,...a}){return(0,t.jsx)("input",{type:s,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-10 w-full min-w-0 rounded-lg border-2 bg-transparent px-4 py-2.5 text-sm font-medium shadow-sm transition-all outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-semibold disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50","focus-visible:border-primary focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:shadow-md","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive","hover:border-primary/50",e),...a})}e.s(["Input",()=>s])},10708,e=>{"use strict";var t=e.i(43476),r=e.i(71645);e.i(74080);var s=e.i(91918),a=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{let i=(0,s.createSlot)(`Primitive.${a}`),l=r.forwardRef((e,r)=>{let{asChild:s,...l}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(s?i:a,{...l,ref:r})});return l.displayName=`Primitive.${a}`,{...e,[a]:l}},{}),i=r.forwardRef((e,r)=>(0,t.jsx)(a.label,{...e,ref:r,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));i.displayName="Label";var l=e.i(47163);let n=r.forwardRef(({className:e,...r},s)=>(0,t.jsx)(i,{ref:s,className:(0,l.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...r}));n.displayName=i.displayName,e.s(["Label",()=>n],10708)},88653,e=>{"use strict";e.i(47167);var t=e.i(43476),r=e.i(71645),s=e.i(31178),a=e.i(47414),i=e.i(74008),l=e.i(21476),n=e.i(72846),o=r,d=e.i(37806);function c(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class u extends o.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,r=(0,n.isHTMLElement)(e)&&e.offsetWidth||0,s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft,s.right=r-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function m({children:e,isPresent:s,anchorX:a,root:i}){let l=(0,o.useId)(),n=(0,o.useRef)(null),m=(0,o.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:p}=(0,o.useContext)(d.MotionConfigContext),f=function(...e){return r.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=c(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():c(e[t],null)}}}}(...e),e)}(n,e?.ref);return(0,o.useInsertionEffect)(()=>{let{width:e,height:t,top:r,left:o,right:d}=m.current;if(s||!n.current||!e||!t)return;let c="left"===a?`left: ${o}`:`right: ${d}`;n.current.dataset.motionPopId=l;let u=document.createElement("style");p&&(u.nonce=p);let f=i??document.head;return f.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${l}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${t}px !important;
            ${c}px !important;
            top: ${r}px !important;
          }
        `),()=>{f.contains(u)&&f.removeChild(u)}},[s]),(0,t.jsx)(u,{isPresent:s,childRef:n,sizeRef:m,children:o.cloneElement(e,{ref:f})})}let p=({children:e,initial:s,isPresent:i,onExitComplete:n,custom:o,presenceAffectsLayout:d,mode:c,anchorX:u,root:p})=>{let x=(0,a.useConstant)(f),h=(0,r.useId)(),g=!0,v=(0,r.useMemo)(()=>(g=!1,{id:h,initial:s,isPresent:i,custom:o,onExitComplete:e=>{for(let t of(x.set(e,!0),x.values()))if(!t)return;n&&n()},register:e=>(x.set(e,!1),()=>x.delete(e))}),[i,x,n]);return d&&g&&(v={...v}),(0,r.useMemo)(()=>{x.forEach((e,t)=>x.set(t,!1))},[i]),r.useEffect(()=>{i||x.size||!n||n()},[i]),"popLayout"===c&&(e=(0,t.jsx)(m,{isPresent:i,anchorX:u,root:p,children:e})),(0,t.jsx)(l.PresenceContext.Provider,{value:v,children:e})};function f(){return new Map}var x=e.i(64978);let h=e=>e.key||"";function g(e){let t=[];return r.Children.forEach(e,e=>{(0,r.isValidElement)(e)&&t.push(e)}),t}let v=({children:e,custom:l,initial:n=!0,onExitComplete:o,presenceAffectsLayout:d=!0,mode:c="sync",propagate:u=!1,anchorX:m="left",root:f})=>{let[v,y]=(0,x.usePresence)(u),b=(0,r.useMemo)(()=>g(e),[e]),j=u&&!v?[]:b.map(h),N=(0,r.useRef)(!0),w=(0,r.useRef)(b),C=(0,a.useConstant)(()=>new Map),[k,S]=(0,r.useState)(b),[P,E]=(0,r.useState)(b);(0,i.useIsomorphicLayoutEffect)(()=>{N.current=!1,w.current=b;for(let e=0;e<P.length;e++){let t=h(P[e]);j.includes(t)?C.delete(t):!0!==C.get(t)&&C.set(t,!1)}},[P,j.length,j.join("-")]);let F=[];if(b!==k){let e=[...b];for(let t=0;t<P.length;t++){let r=P[t],s=h(r);j.includes(s)||(e.splice(t,0,r),F.push(r))}return"wait"===c&&F.length&&(e=F),E(g(e)),S(b),null}let{forceRender:I}=(0,r.useContext)(s.LayoutGroupContext);return(0,t.jsx)(t.Fragment,{children:P.map(e=>{let r=h(e),s=(!u||!!v)&&(b===P||j.includes(r));return(0,t.jsx)(p,{isPresent:s,initial:(!N.current||!!n)&&void 0,custom:l,presenceAffectsLayout:d,mode:c,root:f,onExitComplete:s?void 0:()=>{if(!C.has(r))return;C.set(r,!0);let e=!0;C.forEach(t=>{t||(e=!1)}),e&&(I?.(),E(w.current),u&&y?.(),o&&o())},anchorX:m,children:e},r)})})};e.s(["AnimatePresence",()=>v],88653)},44307,e=>{"use strict";var t=e.i(43476),r=e.i(63270),s=e.i(94179),a=e.i(75254);let i=(0,a.default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),l=(0,a.default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);var n=e.i(14764);let o=(0,a.default)("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),d=(0,a.default)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var c=e.i(23750),u=e.i(67881),m=e.i(61668),p=e.i(71645),f=e.i(20682),x=e.i(46932),h=e.i(88653);async function g(){return{totalTopups:250,activeServers:3,referralIncome:12.5,telegram:"@johndoe",createdAt:"2025-01-15T10:30:00Z",email:"new_email@example.com"}}async function v(e,t){let r=new FormData;r.append("file",e),r.append("userId",t);let s=await fetch("/api/profile/avatar",{method:"POST",body:r});return await s.json()}async function y(e){return e&&/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(e)?{success:!0,email:e}:{success:!1}}function b(){let{user:e,refresh:a}=(0,m.useAuth)(),b=e?.profile,{toast:j}=(0,f.useToast)(),N=(0,p.useRef)(null),[w,C]=(0,p.useState)({totalTopups:0,activeServers:0,referralIncome:0,telegram:"",createdAt:"",email:""}),[k,S]=(0,p.useState)(b?.avatarUrl??null),[P,E]=(0,p.useState)(!1),[F,I]=(0,p.useState)(!1),[T,A]=(0,p.useState)(""),[L,R]=(0,p.useState)(!1);if((0,p.useEffect)(()=>{g().then(C).catch(()=>{})},[]),(0,p.useEffect)(()=>{A(w.email&&w.email!==e?.email?w.email:e?.email||"")},[w,e]),(0,p.useEffect)(()=>{b?.avatarUrl&&S(b.avatarUrl)},[b?.avatarUrl]),!e)return null;let M=w.email&&w.email!==e.email?w.email:e.email,$=w.email&&w.email!==e.email?e.email:null,U=b?.fullName||e.name||M,z=U?U.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"U",B=w.createdAt?new Date(w.createdAt).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"}):"—",D=e.id?e.id.slice(0,8):"",O=w.telegram||"",H=async t=>{let r=t.target.files?.[0];if(r){if(!r.type.startsWith("image/"))return void j({title:"Ошибка",description:"Можно загрузить только изображение.",variant:"destructive"});if(r.size>3145728)return void j({title:"Ошибка",description:"Максимальный размер файла — 3МБ.",variant:"destructive"});E(!0);try{let t=await v(r,e.id);if(!t.success||!t.url)throw Error("Fail");S(t.url),j({title:"Успешно",description:"Аватар обновлён"}),a&&await a()}catch{j({title:"Ошибка",description:"Не удалось загрузить аватар",variant:"destructive"})}finally{E(!1),N.current&&(N.current.value="")}}},W=async()=>{if(!T||T===M)return void I(!1);R(!0);try{if(!(await y(T)).success)throw Error("Failed");C(e=>({...e,email:T})),j({title:"Успешно",description:"Почта обновлена. Проверьте почту для подтверждения."}),I(!1),a&&await a()}catch{j({title:"Ошибка",description:"Не удалось изменить email.",variant:"destructive"})}finally{R(!1)}};return(0,t.jsx)("div",{className:"card-gradient rounded-xl p-6 lg:p-8 border border-border/50",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center md:items-start gap-4",children:[(0,t.jsxs)("div",{className:"relative group cursor-pointer w-36 h-36 transition-transform duration-300 hover:scale-[1.03]",onClick:()=>!P&&N.current?.click(),children:[(0,t.jsx)(r.Avatar,{className:"w-36 h-36 border-2 border-primary/40 shadow-lg",children:(0,t.jsx)(h.AnimatePresence,{mode:"wait",children:k?(0,t.jsx)(x.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"w-full h-full",children:(0,t.jsx)(r.AvatarImage,{src:k,alt:"avatar",className:"object-cover w-full h-full"})},k):(0,t.jsx)(r.AvatarFallback,{className:"text-3xl bg-primary text-primary-foreground",children:z})})}),(0,t.jsxs)("div",{className:"absolute inset-0 flex items-end justify-end opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black/40 rounded-full"}),(0,t.jsx)("div",{className:"relative m-2 rounded-full bg-white/75 p-2 shadow-md z-10",children:(0,t.jsx)(d,{className:"w-6 h-6 text-primary"})})]}),P&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/40 rounded-full",children:(0,t.jsxs)("svg",{className:"animate-spin h-7 w-7 text-primary",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]})}),(0,t.jsx)("input",{ref:N,type:"file",accept:"image/*",className:"hidden",onChange:H})]}),(0,t.jsx)(s.Badge,{variant:"secondary",className:"text-sm",children:"admin"===e.role?"Admin":"User"})]}),(0,t.jsxs)("div",{className:"flex-1 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-foreground mb-1",children:U}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"—"!==B?`Участник с ${B}`:"—"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center",children:(0,t.jsx)(l,{className:"w-5 h-5 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:$?"Новая почта":"Email"}),F?(0,t.jsxs)("div",{className:"flex gap-2 items-center mt-1",children:[(0,t.jsx)(c.Input,{value:T,onChange:e=>A(e.target.value),placeholder:"Новый email",className:"max-w-xs h-8 px-2 py-1 text-sm",disabled:L,autoFocus:!0,type:"email"}),(0,t.jsx)(u.Button,{size:"sm",variant:"outline",onClick:W,disabled:L||!T||!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(T),className:"px-2",children:L?"...":"Сохранить"}),(0,t.jsx)(u.Button,{size:"icon",variant:"ghost",onClick:()=>I(!1),className:"w-7 h-7",type:"button",children:"✕"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-foreground inline-block",children:M}),(0,t.jsx)(u.Button,{size:"sm",variant:"link",className:"px-1 text-xs ml-2",onClick:()=>I(!0),type:"button",children:"Изменить"})]}),$&&!F&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:(0,t.jsxs)("span",{className:"opacity-70",children:["Старая: ",$]})})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center",children:(0,t.jsx)(n.Send,{className:"w-5 h-5 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Telegram"}),(0,t.jsx)("p",{className:"text-sm font-medium text-foreground",children:O||"—"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center",children:(0,t.jsx)(i,{className:"w-5 h-5 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Дата регистрации"}),(0,t.jsx)("p",{className:"text-sm font-medium text-foreground",children:B})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center",children:(0,t.jsx)(o,{className:"w-5 h-5 text-primary"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"ID пользователя"}),(0,t.jsxs)("p",{className:"text-sm font-medium text-foreground",children:["#",D]})]})]})]}),(0,t.jsx)("div",{className:"pt-4 border-t border-border/50",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Всего пополнений"}),(0,t.jsxs)("p",{className:"text-xl font-bold text-foreground",children:["$",w.totalTopups.toFixed(2)]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Активных серверов"}),(0,t.jsx)("p",{className:"text-xl font-bold text-foreground",children:w.activeServers})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-1",children:"Реферальный доход"}),(0,t.jsxs)("p",{className:"text-xl font-bold text-foreground",children:["$",w.referralIncome.toFixed(2)]})]})]})})]})]})})}e.s(["ProfileInfo",()=>b],44307)},77692,e=>{"use strict";var t=e.i(43476),r=e.i(67881),s=e.i(23750),a=e.i(10708),i=e.i(71645),l=e.i(20682),n=e.i(61668),o=e.i(24083);function d(){let{user:e,refresh:d}=(0,n.useAuth)(),{toast:c}=(0,l.useToast)(),{language:u}=(0,o.useLanguage)(),[m,p]=(0,i.useState)(""),[f,x]=(0,i.useState)(""),[h,g]=(0,i.useState)(""),[v,y]=(0,i.useState)(""),[b,j]=(0,i.useState)(!1),[N,w]=(0,i.useState)(!1);(0,i.useEffect)(()=>{e?.profile?.fullName&&p(e.profile.fullName)},[e]);let C=async()=>{j(!0);try{if(!(await fetch("/api/profile",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullName:m})})).ok)throw Error("Failed to update profile");await d(),c({title:"ru"===u?"Успешно":"Success",description:"ru"===u?"Профиль обновлен":"Profile updated"})}catch(e){c({title:"ru"===u?"Ошибка":"Error",description:"ru"===u?"Не удалось обновить профиль":"Failed to update profile",variant:"destructive"})}finally{j(!1)}},k=async()=>{if(h!==v)return void c({title:"ru"===u?"Ошибка":"Error",description:"ru"===u?"Пароли не совпадают":"Passwords do not match",variant:"destructive"});if(h.length<8)return void c({title:"ru"===u?"Ошибка":"Error",description:"ru"===u?"Пароль должен быть не менее 8 символов":"Password must be at least 8 characters",variant:"destructive"});w(!0);try{let e=await fetch("/api/user/password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:f,newPassword:h})}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to change password");x(""),g(""),y(""),c({title:"ru"===u?"Успешно":"Success",description:"ru"===u?"Пароль успешно изменен":"Password changed successfully"})}catch(e){c({title:"ru"===u?"Ошибка":"Error",description:e.message||("ru"===u?"Не удалось изменить пароль":"Failed to change password"),variant:"destructive"})}finally{w(!1)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"card-gradient rounded-xl p-6 lg:p-8 border border-border/50",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-foreground mb-6",children:"ru"===u?"Настройки профиля":"Profile Settings"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a.Label,{htmlFor:"fullName",className:"text-foreground",children:"ru"===u?"Полное имя":"Full Name"}),(0,t.jsx)(s.Input,{id:"fullName",value:m,onChange:e=>p(e.target.value),className:"bg-background/50 border-border/50 focus:border-primary",placeholder:"ru"===u?"Введите ваше имя":"Enter your name"})]}),(0,t.jsx)(r.Button,{className:"bg-primary hover:bg-primary/90",onClick:C,disabled:b,children:b?"ru"===u?"Сохранение...":"Saving...":"ru"===u?"Сохранить изменения":"Save changes"})]})]}),(0,t.jsxs)("div",{className:"card-gradient rounded-xl p-6 lg:p-8 border border-border/50",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-foreground mb-6",children:"ru"===u?"Изменить пароль":"Change Password"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a.Label,{htmlFor:"current-password",className:"text-foreground",children:"ru"===u?"Текущий пароль":"Current Password"}),(0,t.jsx)(s.Input,{id:"current-password",type:"password",value:f,onChange:e=>x(e.target.value),className:"bg-background/50 border-border/50 focus:border-primary"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a.Label,{htmlFor:"new-password",className:"text-foreground",children:"ru"===u?"Новый пароль":"New Password"}),(0,t.jsx)(s.Input,{id:"new-password",type:"password",value:h,onChange:e=>g(e.target.value),className:"bg-background/50 border-border/50 focus:border-primary"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(a.Label,{htmlFor:"confirm-new-password",className:"text-foreground",children:"ru"===u?"Подтвердите новый пароль":"Confirm New Password"}),(0,t.jsx)(s.Input,{id:"confirm-new-password",type:"password",value:v,onChange:e=>y(e.target.value),className:"bg-background/50 border-border/50 focus:border-primary"})]}),(0,t.jsx)(r.Button,{className:"bg-primary hover:bg-primary/90",onClick:k,disabled:N,children:N?"ru"===u?"Изменение...":"Changing...":"ru"===u?"Изменить пароль":"Change Password"})]})]})]})}e.s(["ProfileSettings",()=>d])}]);