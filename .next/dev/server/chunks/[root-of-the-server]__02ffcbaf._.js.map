{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/saefs/Downloads/vds-hub/vds-hub/app/api/crystalpay/route.ts"],"sourcesContent":["\r\nimport { NextResponse } from 'next/server'\r\nimport crypto from 'crypto'\r\n\r\nexport async function POST(request: Request) {\r\n  const { amount, requiredMethod, description, userId } = await request.json()\r\n\r\n  const authLogin = \"lix\"\r\n  const authSecret = \"670abc6a6123ee35e25f4640652c0e6ffb5aeed2\"\r\n  const salt = \"747b9c324e81425ae151d539581339afd7ba9208\"\r\n\r\n  const signatureString = `${amount}:${requiredMethod || ''}:${salt}`\r\n  const signature = crypto.createHash('sha1').update(signatureString).digest('hex')\r\n\r\n  const body = {\r\n    auth_login: authLogin,\r\n    auth_secret: authSecret,\r\n    amount,\r\n    currency: \"USD\",\r\n    type: \"topup\",\r\n    lifetime: 60,\r\n    required_method: requiredMethod || undefined,\r\n    description,\r\n    signature,\r\n    extra: `userId:${userId}`, // optional, can be used for webhook identification\r\n    // payer_details: \"example@email.com\", // optional\r\n    // redirect_url: \"https://your-site/success\", // optional\r\n    // callback_url: \"https://your-site/webhook\", // optional for server-side confirmation\r\n  }\r\n\r\n  try {\r\n    const response = await fetch(\"https://api.crystalpay.io/v3/invoice/create/\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(body),\r\n    })\r\n\r\n    const data = await response.json()\r\n\r\n    if (data.error) {\r\n      return NextResponse.json(data, { status: 400 })\r\n    }\r\n\r\n    return NextResponse.json(data)\r\n  } catch (err) {\r\n    return NextResponse.json({ error: (err as Error).message }, { status: 500 })\r\n  }\r\n}"],"names":[],"mappings":";;;;AACA;AACA;;;AAEO,eAAe,KAAK,OAAgB;IACzC,MAAM,EAAE,MAAM,EAAE,cAAc,EAAE,WAAW,EAAE,MAAM,EAAE,GAAG,MAAM,QAAQ,IAAI;IAE1E,MAAM,YAAY;IAClB,MAAM,aAAa;IACnB,MAAM,OAAO;IAEb,MAAM,kBAAkB,GAAG,OAAO,CAAC,EAAE,kBAAkB,GAAG,CAAC,EAAE,MAAM;IACnE,MAAM,YAAY,gHAAM,CAAC,UAAU,CAAC,QAAQ,MAAM,CAAC,iBAAiB,MAAM,CAAC;IAE3E,MAAM,OAAO;QACX,YAAY;QACZ,aAAa;QACb;QACA,UAAU;QACV,MAAM;QACN,UAAU;QACV,iBAAiB,kBAAkB;QACnC;QACA;QACA,OAAO,CAAC,OAAO,EAAE,QAAQ;IAI3B;IAEA,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,gDAAgD;YAC3E,QAAQ;YACR,SAAS;gBACP,gBAAgB;YAClB;YACA,MAAM,KAAK,SAAS,CAAC;QACvB;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAEhC,IAAI,KAAK,KAAK,EAAE;YACd,OAAO,yLAAY,CAAC,IAAI,CAAC,MAAM;gBAAE,QAAQ;YAAI;QAC/C;QAEA,OAAO,yLAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,KAAK;QACZ,OAAO,yLAAY,CAAC,IAAI,CAAC;YAAE,OAAO,AAAC,IAAc,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IAC5E;AACF","debugId":null}}]
}