{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/Downloads/vds-hub/vds-hub/public/vds-hub/_next/lib/jwt.ts"],"sourcesContent":["import { SignJWT, jwtVerify } from \"jose\"\n\nconst JWT_SECRET = new TextEncoder().encode(process.env.JWT_SECRET || \"your-secret-key-change-in-production\")\nconst JWT_EXPIRES_IN = \"7d\"\n\nexport interface JWTPayload {\n  userId: string\n  email: string\n  role: string\n}\n\nexport async function signToken(payload: JWTPayload): Promise<string> {\n  return await new SignJWT(payload)\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setIssuedAt()\n    .setExpirationTime(JWT_EXPIRES_IN)\n    .sign(JWT_SECRET)\n}\n\nexport async function verifyToken(token: string): Promise<JWTPayload | null> {\n  try {\n    const { payload } = await jwtVerify(token, JWT_SECRET)\n    return payload as JWTPayload\n  } catch (error) {\n    return null\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;;AAEA,MAAM,aAAa,IAAI,cAAc,MAAM,CAAC,QAAQ,GAAG,CAAC,UAAU,IAAI;AACtE,MAAM,iBAAiB;AAQhB,eAAe,UAAU,OAAmB;IACjD,OAAO,MAAM,IAAI,kPAAO,CAAC,SACtB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,gBAClB,IAAI,CAAC;AACV;AAEO,eAAe,YAAY,KAAa;IAC7C,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,sPAAS,EAAC,OAAO;QAC3C,OAAO;IACT,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF"}},
    {"offset": {"line": 44, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/Downloads/vds-hub/vds-hub/public/vds-hub/_next/middleware.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\nimport type { NextRequest } from \"next/server\"\nimport { verifyToken } from \"@/lib/jwt\"\n\n// Update: export as \"middleware\" for Next.js compatibility\nexport async function middleware(request: NextRequest) {\n  const token = request.cookies.get(\"auth-token\")?.value\n  const { pathname } = request.nextUrl\n\n  // Protected routes that require authentication\n  const protectedRoutes = [\"/dashboard\", \"/admin\"]\n  const isProtectedRoute = protectedRoutes.some((route) => pathname.startsWith(route))\n\n  // Admin-only routes\n  const adminRoutes = [\"/admin\"]\n  const isAdminRoute = adminRoutes.some((route) => pathname.startsWith(route))\n\n  // Auth routes (login, register)\n  const authRoutes = [\"/login\", \"/register\"]\n  const isAuthRoute = authRoutes.some((route) => pathname.startsWith(route))\n\n  if (!token && isProtectedRoute) {\n    // Redirect to login if trying to access protected route without token\n    return NextResponse.redirect(new URL(\"/login\", request.url))\n  }\n\n  if (token) {\n    const payload = await verifyToken(token)\n\n    if (!payload) {\n      // Invalid token, clear it and redirect to login if on protected route\n      const response = isProtectedRoute ? NextResponse.redirect(new URL(\"/login\", request.url)) : NextResponse.next()\n      response.cookies.delete(\"auth-token\")\n      return response\n    }\n\n    // Check admin access\n    if (isAdminRoute && payload.role?.toLowerCase() !== \"admin\") {\n      return NextResponse.redirect(new URL(\"/dashboard\", request.url))\n    }\n\n    // Redirect authenticated users away from auth pages\n    if (isAuthRoute) {\n      return NextResponse.redirect(new URL(\"/dashboard\", request.url))\n    }\n  }\n\n  return NextResponse.next()\n}\n\nexport const config = {\n  matcher: [\"/((?!_next/static|_next/image|favicon.ico|.*\\\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)\"],\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAEA;;;AAGO,eAAe,WAAW,OAAoB;IACnD,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,eAAe;IACjD,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IAEpC,+CAA+C;IAC/C,MAAM,kBAAkB;QAAC;QAAc;KAAS;IAChD,MAAM,mBAAmB,gBAAgB,IAAI,CAAC,CAAC,QAAU,SAAS,UAAU,CAAC;IAE7E,oBAAoB;IACpB,MAAM,cAAc;QAAC;KAAS;IAC9B,MAAM,eAAe,YAAY,IAAI,CAAC,CAAC,QAAU,SAAS,UAAU,CAAC;IAErE,gCAAgC;IAChC,MAAM,aAAa;QAAC;QAAU;KAAY;IAC1C,MAAM,cAAc,WAAW,IAAI,CAAC,CAAC,QAAU,SAAS,UAAU,CAAC;IAEnE,IAAI,CAAC,SAAS,kBAAkB;QAC9B,sEAAsE;QACtE,OAAO,0QAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;IAC5D;IAEA,IAAI,OAAO;QACT,MAAM,UAAU,MAAM,IAAA,2MAAW,EAAC;QAElC,IAAI,CAAC,SAAS;YACZ,sEAAsE;YACtE,MAAM,WAAW,mBAAmB,0QAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG,KAAK,0QAAY,CAAC,IAAI;YAC7G,SAAS,OAAO,CAAC,MAAM,CAAC;YACxB,OAAO;QACT;QAEA,qBAAqB;QACrB,IAAI,gBAAgB,QAAQ,IAAI,EAAE,kBAAkB,SAAS;YAC3D,OAAO,0QAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,cAAc,QAAQ,GAAG;QAChE;QAEA,oDAAoD;QACpD,IAAI,aAAa;YACf,OAAO,0QAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,cAAc,QAAQ,GAAG;QAChE;IACF;IAEA,OAAO,0QAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;KAAoF;AAChG"}}]
}